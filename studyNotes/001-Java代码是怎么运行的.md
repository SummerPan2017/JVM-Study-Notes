# java代码在虚拟机中运行

学习Java虚拟机的目的：
1. 理解运行机制
2. 掌握诊断手法
3. 学会调优方式
---

## 1.为何在虚拟机中运行
### 1.1 跨平台
    一旦编译为.class字节码，便能实现在各个平台的虚拟机环境中运行
### 1.2 代码托管环境
    Java虚拟机还提供了一个代码托管环境，处理冗长和容易出错的事务，比如【内存管理】、【垃圾回收】等等
    
   
## 2. 怎样运行
### 2.1 内存分区
    Java虚拟机将运行时的内存区域划分为【5】个部分，Java程序编译成的字节码.class文件需要先加载至方法区中，才能在虚拟机中运行 
    
- 方法区 
- 堆
- pc寄存器
- Java方法栈
- 本地方法栈
![jvm内存划分](../src/main/resources/images/Java虚拟机内存划分.png 'JVM001')


### 2.2 执行方式
- 解释执行：逐条将字节码编译成机器码并执行；
- 即时编译：将一个方法中包含的所有字节码编译成机器码之后再执行
![jvm执行方式](../src/main/resources/images/Java虚拟机两种编译方式.png 'JVM002')


## 3. 运行效率如何
    标准JDK中Hotspot虚拟机采用混合执行的策略
    
1. 【解释执行】字节码，反复执行的热点代码以方法为单位进行【即时编译】，然后将编译的机器码运行在硬件上运行

2. Hotspot虚拟机装载了不同的【即时编译器】，如C1、C2、Graal，以便在【编译时间】和【生成代码的执行效率】之间做出取舍
    